{"version":3,"sources":["../src/server.tsx"],"sourcesContent":["import { cookies } from 'next/headers';\nimport { CookieAttributes, Cookies } from './types';\nimport type { ResponseCookie } from 'next/dist/compiled/@edge-runtime/cookies';\nimport React, { FC, ReactNode } from 'react';\nimport { SecureCookiesProvider } from './provider';\nimport { storeSecureCookies } from './secure';\n\nexport const CookiesProvider: FC<{ children: ReactNode }> = ({ children }) => {\n  const secretValue = cookies().getAll();\n\n  return (\n    <SecureCookiesProvider value={storeSecureCookies(secretValue)}>\n      {children}\n    </SecureCookiesProvider>\n  );\n};\n\nexport const getCookies = (): Cookies => {\n  const org = cookies();\n\n  return {\n    get: (name?: string) =>\n      (name == null\n        ? Object.fromEntries(org.getAll().map((c) => [c.name, c.value]))\n        : org.get(name)?.value) as never,\n\n    set: (name, value, options) => {\n      const pre = org.get(name)?.value;\n      org.set(name, value, options && convertCookieAttributes(options));\n      return pre;\n    },\n\n    remove: (name) => org.delete(name),\n  };\n};\n\nconst convertCookieAttributes = (\n  options: CookieAttributes,\n): Partial<ResponseCookie> => ({\n  expires:\n    typeof options.expires === 'number'\n      ? options.expires * 864e5\n      : options.expires,\n  path: options.path,\n  domain: options.domain,\n  secure: options.secure,\n  sameSite: options.sameSite?.toLowerCase() as\n    | 'strict'\n    | 'lax'\n    | 'none'\n    | undefined,\n});\n"],"mappings":";;AAAA,SAASA,eAAe;AAGxB,OAAOC,WAA8B;AACrC,SAASC,6BAA6B;AACtC,SAASC,0BAA0B;AAE5B,MAAMC,kBAA+C,wBAAC,EAAEC,SAAQ,MAAE;AACvE,QAAMC,cAAcN,QAAAA,EAAUO,OAAM;AAEpC,SACE,sBAAA,cAACL,uBAAAA;IAAsBM,OAAOL,mBAAmBG,WAAAA;KAC9CD,QAAAA;AAGP,GAR4D;AAUrD,MAAMI,aAAa,6BAAA;AACxB,QAAMC,MAAMV,QAAAA;AAEZ,SAAO;IACLW,KAAK,CAACC,SACHA,QAAQ,OACLC,OAAOC,YAAYJ,IAAIH,OAAM,EAAGQ,IAAI,CAACC,MAAM;MAACA,EAAEJ;MAAMI,EAAER;KAAM,CAAA,IAC5DE,IAAIC,IAAIC,IAAAA,GAAOJ;IAErBS,KAAK,CAACL,MAAMJ,OAAOU,YAAAA;AACjB,YAAMC,MAAMT,IAAIC,IAAIC,IAAAA,GAAOJ;AAC3BE,UAAIO,IAAIL,MAAMJ,OAAOU,WAAWE,wBAAwBF,OAAAA,CAAAA;AACxD,aAAOC;IACT;IAEAE,QAAQ,CAACT,SAASF,IAAIY,OAAOV,IAAAA;EAC/B;AACF,GAjB0B;AAmB1B,MAAMQ,0BAA0B,wBAC9BF,aAC6B;EAC7BK,SACE,OAAOL,QAAQK,YAAY,WACvBL,QAAQK,UAAU,QAClBL,QAAQK;EACdC,MAAMN,QAAQM;EACdC,QAAQP,QAAQO;EAChBC,QAAQR,QAAQQ;EAChBC,UAAUT,QAAQS,UAAUC,YAAAA;AAK9B,IAfgC;","names":["cookies","React","SecureCookiesProvider","storeSecureCookies","CookiesProvider","children","secretValue","getAll","value","getCookies","org","get","name","Object","fromEntries","map","c","set","options","pre","convertCookieAttributes","remove","delete","expires","path","domain","secure","sameSite","toLowerCase"]}